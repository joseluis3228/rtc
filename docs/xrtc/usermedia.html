<!DOCTYPE html />

<html>
<head>
	<title>UserMedia.js</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<link href="../nocco.css" rel="stylesheet" media="all" type="text/css" />
	<script src="../prettify.js" type="text/javascript"></script>
</head>
<body onload="prettyPrint()">
	<div id="container">
		<div id="background"></div>
			<div id="jump_to">
				Jump To &hellip;
				<div id="jump_wrapper">
					<div id="jump_page">
							<a class="source" href="../xrtc/ajax.html">
								xrtc\Ajax.js
							</a>
							<a class="source" href="../xrtc/authmanager.html">
								xrtc\AuthManager.js
							</a>
							<a class="source" href="../xrtc/class.html">
								xrtc\Class.js
							</a>
							<a class="source" href="../xrtc/common.html">
								xrtc\Common.js
							</a>
							<a class="source" href="../xrtc/commonerror.html">
								xrtc\CommonError.js
							</a>
							<a class="source" href="../xrtc/connection.html">
								xrtc\Connection.js
							</a>
							<a class="source" href="../xrtc/datachannel.html">
								xrtc\DataChannel.js
							</a>
							<a class="source" href="../xrtc/eventdispatcher.html">
								xrtc\EventDispatcher.js
							</a>
							<a class="source" href="../xrtc/handshakecontroller.html">
								xrtc\HandshakeController.js
							</a>
							<a class="source" href="../xrtc/logger.html">
								xrtc\Logger.js
							</a>
							<a class="source" href="../xrtc/room.html">
								xrtc\Room.js
							</a>
							<a class="source" href="../xrtc/serverconnector.html">
								xrtc\ServerConnector.js
							</a>
							<a class="source" href="../xrtc/stream.html">
								xrtc\Stream.js
							</a>
							<a class="source" href="../xrtc/usermedia.html">
								xrtc\UserMedia.js
							</a>
					</div>
				</div>
			</div>
		<table cellpadding="0" cellspacing="0">
			<thead>
				<tr>
					<th class="docs">
						<h1>UserMedia.js</h1>
					</th>
					<th class="code"></th>
				</tr>
			</thead>
			<tbody>
					<tr id="section_1">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_1">&#182;</a>
							</div>
							<h4>Version 1.3.0</h4>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
</code></pre>
						</td>
					</tr>
					<tr id="section_2">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_2">&#182;</a>
							</div>
							<p><code>xRtc.getUserMedia</code> is the special functions for accessing media data:</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
</code></pre>
						</td>
					</tr>
					<tr id="section_3">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_3">&#182;</a>
							</div>
							<ul>
<li>audio</li>
<li>video</li>
<li>screen sharing</li>
</ul>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
&#39;use strict&#39;;

(function (exports) {
	var xrtc = exports.xRtc,
		webrtc = xrtc.webrtc,
		logger = new xrtc.Logger(&quot;UserMedia&quot;),
		getUserMedia = function(options, successCallback, errorCallback) {
			webrtc.getUserMedia(options, onGetUserMediaSuccess, onGetUserMediaError);

			function onGetUserMediaSuccess(stream) {
				if (typeof successCallback === &quot;function&quot;) {
					successCallback(new xrtc.Stream(stream));
				}
			}

			function onGetUserMediaError(err) {
				if (typeof errorCallback === &quot;function&quot;) {
					errorCallback(err);
				}
			}
		};

</code></pre>
						</td>
					</tr>
					<tr id="section_4">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_4">&#182;</a>
							</div>
							<p><strong>[Public API]:</strong> Asks user to allow use local devices, e.g. <strong>camera</strong>, <strong>microphone</strong>, <strong>screen</strong>.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
</code></pre>
						</td>
					</tr>
					<tr id="section_5">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_5">&#182;</a>
							</div>
							<p><strong>Note:</strong> Screen sharing available only for <em>Chrome 25+</em> with special flag <code>#enable-usermedia-screen-capture</code> and only in case
when application (app which uses xRtc) was loaded by <strong>HTTPS</strong> protocol.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
</code></pre>
						</td>
					</tr>
					<tr id="section_6">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_6">&#182;</a>
							</div>
							<p><strong>Simple examples:</strong></p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
</code></pre>
						</td>
					</tr>
					<tr id="section_7">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_7">&#182;</a>
							</div>
							<ul>
<li><code>xRtc.getUserMedia({ audio: true, video: true }, function(stream){}, function(error){});</code></li>
<li><code>xRtc.getUserMedia({ audio: true }, function(stream){}, function(error){});</code></li>
<li><code>xRtc.getUserMedia({ video: true }, function(stream){}, function(error){});</code></li>
<li><code>xRtc.getUserMedia({ video: { mandatory: { mediaSource: "screen" } } }, function(stream){}, function(error){});</code></li>
<li><code>xRtc.getUserMedia({ video: { mandatory: { mediaSource: "screen" } }, audio: true }, function(stream){}, function(error){});</code></li>
<li><code>xRtc.getUserMedia({ video: { mandatory: { minWidth: 1280, maxWidth: 1280, minHeight: 720, maxHeight: 720, minFrameRate: 30 }}, function(stream){}, function(error){});</code></li>
</ul>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
</code></pre>
						</td>
					</tr>
					<tr id="section_8">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_8">&#182;</a>
							</div>
							<p><strong>Note:</strong> xRtc.getUserMedia uses the same option as native browser's getUserMedia. Some examples of otions you can find here:
<a href="http://webrtc.googlecode.com/svn/trunk/samples/js/demos/html/constraints-and-stats.html">http://webrtc.googlecode.com/svn/trunk/samples/js/demos/html/constraints-and-stats.html</a></p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	xrtc.getUserMedia = function (options, successCallback, errorCallback) {
		if (options &amp;&amp; !options.video &amp;&amp; !options.audio) {
			var error = new xrtc.CommonError(&#39;getUserMedia&#39;, &quot;video or audio property of the options parameter should be specified. No sense to create media stream without video and audio components.&quot;);
			logger.error(&#39;onCreateOfferError&#39;, error);
		}

		var mediaOptions = options || { video: true, audio: true };
		if (mediaOptions.video &amp;&amp; mediaOptions.video.mandatory &amp;&amp; mediaOptions.video.mandatory.mediaSource === &quot;screen&quot;) {
			getUserMedia.call(this, { video: { mandatory: { chromeMediaSource: &quot;screen&quot; } } }, function (screenSharingStream) {
				if (mediaOptions.audio) {
</code></pre>
						</td>
					</tr>
					<tr id="section_9">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_9">&#182;</a>
							</div>
							<p><em>FF 20.0.1: (Not shure about other version, FF 21 works fine)</em>
reduces the overall sound of the computer (playing using <em>Chrome</em> and maybe another <em>FF</em>) after calling this functionality.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>					getUserMedia.call(this, { audio: true }, function (audioStream) {
						function addTracks(array, tracks) {
							for (var i = 0; i &lt; tracks.length; i++) {
								array.push(tracks[i]);
							}
						}

</code></pre>
						</td>
					</tr>
					<tr id="section_10">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_10">&#182;</a>
							</div>
							<p>Combine audio and video components of different streams in one stream.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>						var mediaStreamTracks = [];
						addTracks(mediaStreamTracks, audioStream.getAudioTracks());
						addTracks(mediaStreamTracks, screenSharingStream.getVideoTracks());

						successCallback(new webrtc.MediaStream(mediaStreamTracks));
					}, errorCallback);
				} else {
					successCallback(screenSharingStream);
				}
			}, errorCallback);
		} else {
			getUserMedia.call(this, mediaOptions, successCallback, errorCallback);
		}
	};
})(window);
</code></pre>
						</td>
					</tr>
			</tbody>
		</table>
	</div>
</body>
</html>
